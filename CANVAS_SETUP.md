# Axiom Canvas æ¨¡å—åŒ–ç³»ç»Ÿ - å¼€å‘æŒ‡å—

## æ¶æ„æ¦‚è¿°

è¿™æ˜¯ Axiom çš„æ–°æ¶æ„ï¼Œé‡‡ç”¨ Canvas + Module æ¨¡å—åŒ–ç³»ç»Ÿï¼Œæ›¿ä»£åŸæœ‰çš„å•æ¬¡ç”Ÿæˆæ¨¡å¼ã€‚

### æ ¸å¿ƒæ¦‚å¿µ

1. **Canvasï¼ˆç”»å¸ƒï¼‰**: ä¸€ä¸ªå®Œæ•´çš„å­¦ä¹ ç©ºé—´ï¼ŒåŒ…å«å¤šä¸ªæ¨¡å—
2. **Moduleï¼ˆæ¨¡å—ï¼‰**: Canvas ä¸­çš„ä¸€ä¸ªç‹¬ç«‹å†…å®¹å•å…ƒï¼ˆå¦‚å®šä¹‰ã€ç¤ºä¾‹ã€æµ‹éªŒç­‰ï¼‰
3. **ModuleVersionï¼ˆæ¨¡å—ç‰ˆæœ¬ï¼‰**: æ¨¡å—çš„å†å²ç‰ˆæœ¬ï¼Œæ”¯æŒè¿­ä»£ç¼–è¾‘

### æŠ€æœ¯æ ˆ

- **å‰ç«¯**: React + TypeScript + Vite
- **åç«¯**: Express + TypeScript
- **æ•°æ®åº“**: SQLite (better-sqlite3)
- **AI**: Google Geminiï¼ˆæš‚æ—¶ç”¨å‡æ•°æ®ä»£æ›¿ï¼‰

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

åŒæ—¶å¯åŠ¨å‰ç«¯å’Œåç«¯ï¼š

```bash
npm run dev:all
```

æˆ–è€…åˆ†åˆ«å¯åŠ¨ï¼š

```bash
# ç»ˆç«¯ 1 - å‰ç«¯ (ç«¯å£ 5173)
npm run dev

# ç»ˆç«¯ 2 - åç«¯ (ç«¯å£ 3001)
npm run dev:server
```

### 3. è®¿é—®åº”ç”¨

- å‰ç«¯: http://localhost:5173
- åç«¯ API: http://localhost:3001/api

## é¡¹ç›®ç»“æ„

```
Axiom-new/
â”œâ”€â”€ server/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ index.ts           # æœåŠ¡å™¨å…¥å£
â”‚   â”œâ”€â”€ db.ts              # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ types.ts           # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ planner.ts         # å‡ Plannerï¼ˆhardcode è§„åˆ™ï¼‰
â”‚   â””â”€â”€ routes/            # API è·¯ç”±
â”‚       â”œâ”€â”€ canvases.ts    # Canvas ç›¸å…³ API
â”‚       â””â”€â”€ modules.ts     # Module ç›¸å…³ API
â”œâ”€â”€ components/            # React ç»„ä»¶
â”‚   â”œâ”€â”€ CanvasPage.tsx     # Canvas ä¸»é¡µé¢
â”‚   â””â”€â”€ ModuleCard.tsx     # æ¨¡å—å¡ç‰‡ç»„ä»¶
â”œâ”€â”€ apiService.ts          # å‰ç«¯ API å®¢æˆ·ç«¯
â”œâ”€â”€ data/                  # æ•°æ®åº“æ–‡ä»¶ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â””â”€â”€ axiom.db          # SQLite æ•°æ®åº“
â””â”€â”€ App.tsx               # åº”ç”¨å…¥å£
```

## æ•°æ®åº“ç»“æ„

### Canvas è¡¨
```sql
id, title, domain, status, created_at
```

### Module è¡¨
```sql
id, canvas_id, type, status, order_index
```

### ModuleVersion è¡¨
```sql
id, module_id, prompt, content_json, created_at
```

## API ç«¯ç‚¹

### Canvas API

- `POST /api/canvases` - åˆ›å»ºæ–° Canvas
  - Body: `{ topic: string, domain: 'LANGUAGE' | 'SCIENCE' | 'LIBERAL_ARTS' }`
  
- `GET /api/canvases/:id` - è·å– Canvas è¯¦æƒ…
  
- `GET /api/canvases` - è·å–æ‰€æœ‰ Canvas
  
- `POST /api/canvases/:id/expand` - æ·»åŠ æ–°æ¨¡å—åˆ° Canvas
  - Body: `{ prompt: string }`
  
- `POST /api/canvases/:id/new` - å½’æ¡£å½“å‰ Canvas å¹¶åˆ›å»ºæ–°çš„
  - Body: `{ new_topic: string }`

### Module API

- `POST /api/modules/:id/edit` - ç¼–è¾‘æ¨¡å—ï¼ˆåˆ›å»ºæ–°ç‰ˆæœ¬ï¼‰
  - Body: `{ prompt: string }`
  
- `GET /api/modules/:id/versions` - è·å–æ¨¡å—çš„ç‰ˆæœ¬å†å²
  
- `DELETE /api/modules/:id` - åˆ é™¤æ¨¡å—

## Content JSON åè®®

ç»Ÿä¸€çš„å†…å®¹æ ¼å¼ï¼Œæ”¯æŒå¤šç§ç±»å‹ï¼š

### æ–‡æœ¬å†…å®¹
```json
{
  "type": "text",
  "title": "æ ‡é¢˜",
  "body": "æ­£æ–‡å†…å®¹",
  "subtitle": "å¯é€‰å‰¯æ ‡é¢˜"
}
```

### æµ‹éªŒå†…å®¹
```json
{
  "type": "quiz",
  "title": "æµ‹éªŒæ ‡é¢˜",
  "questions": [
    {
      "question": "é—®é¢˜",
      "options": ["é€‰é¡¹1", "é€‰é¡¹2"],
      "answer_index": 0,
      "explanation": "è§£é‡Š"
    }
  ]
}
```

### äº¤äº’åº”ç”¨
```json
{
  "type": "interactive_app",
  "title": "åº”ç”¨æ ‡é¢˜",
  "app_data": { /* è‡ªå®šä¹‰æ•°æ® */ },
  "description": "æè¿°"
}
```

### è§†é¢‘å†…å®¹
```json
{
  "type": "video",
  "title": "è§†é¢‘æ ‡é¢˜",
  "video_url": "è§†é¢‘åœ°å€",
  "thumbnail_url": "ç¼©ç•¥å›¾",
  "description": "æè¿°"
}
```

### HTML åŠ¨ç”»
```json
{
  "type": "html_animation",
  "title": "åŠ¨ç”»æ ‡é¢˜",
  "html_content": "<div>...</div>",
  "description": "æè¿°"
}
```

## æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å®ç°

1. **åˆ›å»º Canvas**: è¾“å…¥ä¸»é¢˜å’Œé¢†åŸŸï¼Œè‡ªåŠ¨ç”Ÿæˆ 2-4 ä¸ªåˆå§‹æ¨¡å—
2. **æ¨¡å—ç¼–è¾‘**: ç‚¹å‡»æ¨¡å—å¡ç‰‡ï¼Œè¾“å…¥ç¼–è¾‘æŒ‡ä»¤ï¼Œåªé‡æ–°ç”Ÿæˆè¯¥æ¨¡å—
3. **æ‰©å±• Canvas**: é€šè¿‡åº•éƒ¨ Chat æ·»åŠ æ–°æ¨¡å—
4. **æ–°å»º Canvas**: å½’æ¡£å½“å‰ Canvasï¼Œåˆ›å»ºæ–°ä¸»é¢˜çš„ Canvas
5. **ç‰ˆæœ¬æ§åˆ¶**: æ¯æ¬¡ç¼–è¾‘éƒ½ä¼šåˆ›å»ºæ–°ç‰ˆæœ¬ï¼Œä¸è¦†ç›–å†å²
6. **å±€éƒ¨åˆ·æ–°**: ç¼–è¾‘æ¨¡å—æ—¶åªæ›´æ–°è¯¥æ¨¡å—ï¼Œä¸å½±å“å…¶ä»–æ¨¡å—

### ğŸ”„ å¾…å®ç°

1. **çœŸæ­£çš„ Planner**: æ¥å…¥ Gemini 3 Flashï¼Œæ™ºèƒ½å†³å®šæ¨¡å—ç»“æ„
2. **çœŸæ­£çš„å†…å®¹ç”Ÿæˆ**: æ¥å…¥ Gemini API ç”Ÿæˆå®é™…å†…å®¹
3. **è§†é¢‘ç”Ÿæˆ**: é›†æˆè§†é¢‘ç”Ÿæˆ API
4. **äº¤äº’å¼å®éªŒ**: å®ç°å¯æ“ä½œçš„ç§‘å­¦å®éªŒç•Œé¢
5. **ç‰ˆæœ¬å†å²æŸ¥çœ‹**: å‰ç«¯æ˜¾ç¤ºå’Œåˆ‡æ¢å†å²ç‰ˆæœ¬
6. **æ¨¡å—æ‹–æ‹½æ’åº**: å…è®¸ç”¨æˆ·è°ƒæ•´æ¨¡å—é¡ºåº
7. **Canvas å½’æ¡£åˆ—è¡¨**: æŸ¥çœ‹æ‰€æœ‰å†å² Canvas

## ä½¿ç”¨æµç¨‹

### 1. åˆ›å»ºæ–° Canvas

1. åœ¨é¦–é¡µè¾“å…¥ä¸»é¢˜ï¼ˆå¦‚ "apple"ï¼‰
2. é€‰æ‹©é¢†åŸŸï¼ˆLanguage / Science / Liberal Artsï¼‰
3. ç‚¹å‡»æœç´¢ï¼Œç³»ç»Ÿä¼šï¼š
   - åˆ›å»ºä¸€ä¸ªæ–° Canvas
   - æ ¹æ®é¢†åŸŸç”Ÿæˆ 2-4 ä¸ªåˆå§‹æ¨¡å—
   - è·³è½¬åˆ° Canvas é¡µé¢

### 2. ç¼–è¾‘æ¨¡å—

1. é¼ æ ‡æ‚¬åœåœ¨æ¨¡å—å¡ç‰‡ä¸Š
2. ç‚¹å‡»"ç¼–è¾‘æ­¤æ¨¡å—"
3. è¾“å…¥ç¼–è¾‘æŒ‡ä»¤ï¼ˆå¦‚ï¼š"ä½¿å†…å®¹æ›´ç®€çŸ­"ï¼‰
4. ç‚¹å‡»"é‡æ–°ç”Ÿæˆ"
5. è¯¥æ¨¡å—ä¼šæ›´æ–°ï¼Œå…¶ä»–æ¨¡å—ä¸å˜

### 3. æ·»åŠ æ–°æ¨¡å—

1. ç‚¹å‡»åº•éƒ¨çš„"æ·»åŠ æ¨¡å—"æŒ‰é’®
2. è¾“å…¥æƒ³è¦æ·»åŠ çš„å†…å®¹ï¼ˆå¦‚ï¼š"æ·»åŠ ä¸€ä¸ªæµ‹éªŒ"ï¼‰
3. ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ¤æ–­æ¨¡å—ç±»å‹å¹¶ç”Ÿæˆ

### 4. åˆ›å»ºæ–° Canvas

1. ç‚¹å‡»åº•éƒ¨çš„"æ–°å»º Canvas"æŒ‰é’®
2. è¾“å…¥æ–°ä¸»é¢˜
3. æ—§ Canvas ä¼šè¢«å½’æ¡£ï¼Œåˆ›å»ºæ–°çš„ Canvas

## å¼€å‘è¯´æ˜

### å‡ Planner

å½“å‰ä½¿ç”¨ `server/planner.ts` ä¸­çš„ hardcode è§„åˆ™ï¼š

- **Language**: å®šä¹‰ â†’ ç¤ºä¾‹ â†’ æ•…äº‹ â†’ æµ‹éªŒ
- **Science**: ç›´è§‰ â†’ å®éªŒ â†’ å…¬å¼ â†’ åœºæ™¯
- **Liberal Arts**: æ¦‚è¿° â†’ å†å²è§†è§’ â†’ æ–‡åŒ–è§†è§’ â†’ å“²å­¦è§†è§’

æ‰€æœ‰å†…å®¹éƒ½æ˜¯å‡æ•°æ®ï¼Œå¸¦æœ‰ `ã€æ³¨ï¼šè¿™æ˜¯å‡æ•°æ®ã€‘` æ ‡è®°ã€‚

### æ¥å…¥çœŸå® Gemini

æ›¿æ¢ `server/planner.ts` ä¸­çš„ä¸¤ä¸ªå‡½æ•°ï¼š

1. `generateModulePlan()` - ç”¨ Gemini å†³å®šæ¨¡å—ç»“æ„
2. `generateModuleContent()` - ç”¨ Gemini ç”Ÿæˆå®é™…å†…å®¹

å¯ä»¥å‚è€ƒ `geminiService.ts` çš„è°ƒç”¨æ–¹å¼ã€‚

### æµ‹è¯• API

ä½¿ç”¨ curl æˆ– Postman æµ‹è¯•ï¼š

```bash
# åˆ›å»º Canvas
curl -X POST http://localhost:3001/api/canvases \
  -H "Content-Type: application/json" \
  -d '{"topic": "apple", "domain": "LANGUAGE"}'

# ç¼–è¾‘æ¨¡å—
curl -X POST http://localhost:3001/api/modules/{module_id}/edit \
  -H "Content-Type: application/json" \
  -d '{"prompt": "make it shorter"}'
```

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆè¦ç”¨ Canvas æ¨¡å—åŒ–ç³»ç»Ÿï¼Ÿ

A: 
1. **å¯ç¼–è¾‘æ€§**: ç”¨æˆ·å¯ä»¥åªä¿®æ”¹éƒ¨åˆ†å†…å®¹ï¼Œä¸ç”¨é‡æ–°ç”Ÿæˆæ•´ä¸ªé¡µé¢
2. **å¯æ‰©å±•æ€§**: å¯ä»¥éšæ—¶æ·»åŠ æ–°æ¨¡å—
3. **ç‰ˆæœ¬æ§åˆ¶**: ä¿ç•™ç¼–è¾‘å†å²ï¼Œæ”¯æŒå›æ»š
4. **æˆæœ¬ä¼˜åŒ–**: åªé‡æ–°ç”Ÿæˆéœ€è¦æ”¹å˜çš„éƒ¨åˆ†

### Q: æ•°æ®åº“æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

A: `data/axiom.db`ï¼Œå¦‚æœä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºã€‚

### Q: å¦‚ä½•æ¸…ç©ºæ•°æ®åº“ï¼Ÿ

A: åˆ é™¤ `data/axiom.db` æ–‡ä»¶ï¼Œé‡å¯æœåŠ¡å™¨ä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„ã€‚

### Q: å‰ç«¯å¦‚ä½•çŸ¥é“æ¨¡å—æ›´æ–°äº†ï¼Ÿ

A: ç¼–è¾‘æ¨¡å—æ—¶ï¼Œåç«¯è¿”å›æ–°çš„æ¨¡å—æ•°æ®ï¼Œå‰ç«¯ä½¿ç”¨ React çŠ¶æ€ç®¡ç†å±€éƒ¨æ›´æ–°å¯¹åº”çš„æ¨¡å—ã€‚

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. âœ… å®ŒæˆåŸºç¡€æ¡†æ¶
2. â³ æ¥å…¥çœŸå® Gemini Planner
3. â³ å®ç°è§†é¢‘ç”Ÿæˆ
4. â³ å®ç°äº¤äº’å¼å®éªŒç»„ä»¶
5. â³ æ·»åŠ ç”¨æˆ·åé¦ˆç³»ç»Ÿ
6. â³ æ€§èƒ½ä¼˜åŒ–å’Œé”™è¯¯å¤„ç†

## è´¡çŒ®

è¿™æ˜¯ä¸€ä¸ªæ•™è‚²æ¢ç´¢äº§å“ï¼Œæ¬¢è¿æå‡ºå»ºè®®å’Œæ”¹è¿›ï¼

